#include "main.h"
#include "usb_debouncer.hpp"

/*
 ******************************************************************************
 * DEFINES
 ******************************************************************************
 */

/*
 ******************************************************************************
 * EXTERNS
 ******************************************************************************
 */

/*
 ******************************************************************************
 * GLOBAL VARIABLES
 ******************************************************************************
 */

/*
 *******************************************************************************
 *******************************************************************************
 * LOCAL FUNCTIONS
 *******************************************************************************
 *******************************************************************************
 */


/*
 *******************************************************************************
 * EXPORTED FUNCTIONS
 *******************************************************************************
 */

/**
 *
 */
UsbDebouncer::UsbDebouncer(void) : plugged_flag(false) {
  return;
}

/**
 *
 */
bool UsbDebouncer::update(void){
  bool ret = false;

  if (plugged_flag && (PAL_HIGH == palReadPad(GPIOE, GPIOE_USB_PRESENT)))
    ret = true;

  plugged_flag = (PAL_HIGH == palReadPad(GPIOE, GPIOE_USB_PRESENT));

  return ret;
}

